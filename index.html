<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mobilny Terminal Policyjny - Summer RP</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');

        body {
            font-family: 'Poppins', sans-serif;
            background-color: #0d1117;
            color: #c9d1d9;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        .container {
            width: 100%;
            max-width: 900px;
            background: #161b22;
            padding: 30px 35px;
            border-radius: 15px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.6);
            border: 1px solid #30363d;
        }

        h1 {
            text-align: center;
            margin-bottom: 20px;
            color: #58a6ff;
            font-size: 2em;
            letter-spacing: 1px;
            text-shadow: 0 0 8px rgba(88,166,255,0.2);
            border-bottom: 1px solid #21262d;
            padding-bottom: 12px;
        }

        .tab-buttons {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        button.tab-btn {
            padding: 12px 22px;
            border: none;
            border-radius: 10px;
            background: #21262d;
            color: #8b949e;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 4px 12px rgba(0,0,0,0.25);
        }

        button.tab-btn.active {
            background: #58a6ff;
            color: #0d1117;
            box-shadow: 0 6px 20px rgba(88,166,255,0.25);
        }

        .tab { display: none; animation: fadeIn .4s ease forwards; }
        .tab.active { display: block; }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(6px); }
            to { opacity: 1; transform: translateY(0); }
        }

        form label { font-weight: 600; display:block; margin-top:14px; margin-bottom:6px; color:#c9d1d9; }
        input[type=text], input[type=number], input[type=date], input[type=datetime-local], input[type=time], select, textarea {
            width:100%; padding:10px 12px; font-size:1em; border:1px solid #30363d;
            background:#21262d; color:#c9d1d9; border-radius:8px; box-sizing:border-box;
        }
        textarea { min-height:100px; resize:vertical; font-family: 'Poppins', sans-serif; }

        .row { display:flex; gap:12px; }
        .row > * { flex:1; }

        button[type=submit], .send-btn {
            margin-top:18px; background: linear-gradient(90deg,#38a169,#2f855a); border:none; padding:12px 18px;
            color:white; font-weight:700; border-radius:10px; cursor:pointer; font-size:1em; width:100%;
            box-shadow: 0 4px 15px rgba(56,161,105,0.3);
        }
        button[type=submit]:hover, .send-btn:hover { transform: translateY(-2px); }

        #statusMandat, #statusWniosek, #statusRaport, #statusZatrzymanie {
            margin-top:12px; font-weight:600; text-align:center; min-height:1.5em; padding:8px; border-radius:8px;
        }
        .status-success { background-color:#28a74533; color:#28a745; }
        .status-error   { background-color:#dc354533; color:#dc3545; }

        .checkbox-grid { display:flex; gap:12px; flex-wrap:wrap; }
        .checkbox-grid label { font-weight:500; color:#c9d1d9; display:flex; align-items:center; gap:8px; }
        .small-note { font-size:0.9em; color:#6e7681; margin-top:6px; }

        /* Responsive */
        @media (max-width:740px) {
            .row { flex-direction:column; }
            .container { padding:20px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Mobilny Terminal Policyjny - KWP GDA≈ÉSK</h1>
        <h2>Summer RP</h2>

        <div class="tab-buttons">
            <button class="tab-btn active" onclick="showTab('mandat', event)">Wystaw Mandat</button>
            <button class="tab-btn" onclick="showTab('wniosek', event)">Wniosek do sƒÖdu</button>
            <button class="tab-btn" onclick="showTab('raporty', event)">Raporty (Patrol / Interwencja)</button>
            <button class="tab-btn" onclick="showTab('zatrzymanie', event)">Protok√≥≈Ç Zatrzymania</button>
        </div>

        <div id="mandat" class="tab active">
            <form id="mandatForm">
                <label>Imiƒô i nazwisko ukaranego:</label>
                <input type="text" id="imie" required placeholder="np. Tomasz Malinowski" />

                <label>Nick (OOC):</label>
                <input type="text" id="nick" required placeholder="np. Malina#1122" />

                <div class="row">
                    <div>
                        <label>Data i godzina wystawienia:</label>
                        <input type="datetime-local" id="dataWystawienia" required />
                    </div>
                    <div>
                        <label>Godzina zdarzenia:</label>
                        <input type="time" id="godzinaZdarzenia" required />
                    </div>
                </div>

                <label>Miejsce zdarzenia:</label>
                <input type="text" id="miejsce" required placeholder="np. Gda≈Ñsk, ul. D≈Çuga" />

<label>Przyczyna na≈Ço≈ºenia mandatu:</label>
<select id="przyczyna" required onchange="pokazPoleArtykulu()">
    <option value="" disabled selected>Wybierz przyczynƒô</option>
    <option>Wykroczenia drogowe</option>
    <option>Wykroczenia porzƒÖdkowe i administracyjne</option>
    <option>Wykroczenia przeciwko obrotowi towar√≥w i us≈Çug</option>
    <option>Wykroczenia przeciwko bezpiecze≈Ñstwu i porzƒÖdkowi publicznemu</option>
    <option>Inne</option>
</select>

<div id="innePrzyczynaDiv" style="display:none; margin-top: 10px;">
    <label>Podaj dok≈Çadny artyku≈Ç:</label>
    <input type="text" id="innePrzyczyna" placeholder="Np. Art. 97 Kodeksu wykrocze≈Ñ" />
</div>

<script>
function pokazPoleArtykulu() {
    const select = document.getElementById("przyczyna");
    const inneDiv = document.getElementById("innePrzyczynaDiv");

    // Poka≈º pole po wybraniu dowolnej opcji (poza pustƒÖ)
    if (select.value !== "") {
        inneDiv.style.display = "block";
    } else {
        inneDiv.style.display = "none";
    }
}
</script>

                <div class="row">
                    <div>
                        <label>Kwota mandatu (PLN):</label>
                        <input type="number" id="kwota" min="1" required placeholder="np. 5000" />
                    </div>
                    <div>
                        <label>Punkty karne:</label>
                        <input type="number" id="punkty" min="0" required placeholder="np. 10" />
                    </div>
                </div>

                <label>Typ pojazdu:</label>
                <input type="text" id="pojazd" placeholder="np. Mini van" required />

                <label>Funkcjonariusz (imiƒô i stopie≈Ñ):</label>
                <input type="text" id="funkcjonariusz" placeholder="np. sier≈º. sztab. Marek Nowak" required />

                <button type="submit">Wy≈õlij mandat</button>
            </form>
            <div id="statusMandat"></div>
        </div>

        <div id="wniosek" class="tab">
            <form id="wniosekForm">
                <label>Imiƒô i nazwisko ukaranego:</label>
                <input type="text" id="ukarany" required placeholder="np. Tomasz Malinowski" />

                <label>Nick (OOC):</label>
                <input type="text" id="nickWniosek" placeholder="np. Malina#1122" />

                <div class="row">
                    <div>
                        <label>Data wystawienia mandatu:</label>
                        <input type="date" id="dataMandatu" />
                    </div>
                    <div>
                        <label>Typ mandatu / wykroczenia:</label>
                        <input type="text" id="typMandatu" placeholder="np. Przekroczenie prƒôdko≈õci" />
                    </div>
                </div>

                <label>Kwota mandatu (PLN):</label>
                <input type="number" id="kwotaMandatu" min="0" placeholder="np. 5000" />

                <label>Opis sprawy / pow√≥d wniosku:</label>
                <textarea id="powod" required placeholder="Np. Odwo≈Çanie od mandatu, wyja≈õnienie okoliczno≈õci..."></textarea>

                <button type="submit">Wy≈õlij wniosek</button>
            </form>
            <div id="statusWniosek"></div>
        </div>

        <div id="raporty" class="tab">
            <form id="raportForm">
                <label>Rodzaj raportu:</label>
                <select id="rodzajRaportu" onchange="toggleRaportType()">
                    <option value="patrol">üìã RAPORT ZE S≈ÅU≈ªBY / PATROLU</option>
                    <option value="interwencja">üìÑ RAPORT Z INTERWENCJI</option>
                </select>

                <div id="patrolFields">
                    <label>Komenda:</label>
                    <input type="text" id="komendaPatrol" value="Komenda Wojew√≥dzka Policji w Gda≈Ñsku ‚Äì Summer RP" />

                    <div class="row">
                        <div>
                            <label>Data s≈Çu≈ºby:</label>
                            <input type="date" id="dataSluzby" />
                        </div>
                        <div>
                            <label>Czas trwania s≈Çu≈ºby:</label>
                            <input type="text" id="czasTrwania" placeholder="np. 18:00‚Äì20:00" />
                        </div>
                    </div>

                    <label>Sk≈Çad patrolu (oddzielone nowƒÖ liniƒÖ):</label>
                    <textarea id="skladPatrolu" placeholder="sier≈º. szt. Marek Nowak\nm≈Ç. asp. Anna Jankowska"></textarea>

                    <label>Rodzaj patrolu:</label>
                    <div class="checkbox-grid">
                        <label><input type="checkbox" name="rodzaj" value="Zmotoryzowany" checked> Zmotoryzowany</label>
                        <label><input type="checkbox" name="rodzaj" value="Pieszy"> Pieszy</label>
                        <label><input type="checkbox" name="rodzaj" value="Prewencyjny"> Prewencyjny</label>
                        <label><input type="checkbox" name="rodzaj" value="Kryminalny"> Kryminalny</label>
                        <label><input type="checkbox" name="rodzaj" value="Inny"> Inny</label>
                    </div>
                    <input type="text" id="rodzajInny" placeholder="Je≈ºeli 'Inny' ‚Äì wpisz opis" style="margin-top:8px;" />

                    <label>Obszar patrolu:</label>
                    <input type="text" id="obszarPatrolu" placeholder="np. Gda≈Ñsk ‚Äì ≈ör√≥dmie≈õcie, Wrzeszcz" />

                    <label>Wykonane czynno≈õci (kr√≥tko, ka≈ºdy w nowej linii):</label>
                    <textarea id="czynnosciPatrolu" placeholder="Kontrola 5 pojazd√≥w\nSprawdzenie 3 os√≥b w systemie KSIP\nUdzielenie pomocy..."></textarea>

                    <label>Incydenty i interwencje:</label>
                    <textarea id="incydentyPatrolu" placeholder='Je≈õli by≈Çy ‚Äì kr√≥tki opis lub "Brak"'></textarea>

                    <label>Uwagi w≈Çasne:</label>
                    <textarea id="uwagiPatrolu" placeholder="Np. Patrol przebieg≈Ç spokojnie..."></textarea>

                    <label>Raport sporzƒÖdzi≈Ç (stopie≈Ñ + imiƒô i nazwisko):</label>
                    <input type="text" id="sporadzilPatrol" placeholder="np. sier≈º. szt. Marek Nowak" />

                    <div class="row">
                        <div>
                            <label>Data sporzƒÖdzenia:</label>
                            <input type="date" id="dataSporzadzeniaPatrol" />
                        </div>
                        <div>
                            <label>&nbsp;</label>
                            <button type="button" class="send-btn" onclick="sendPatrolReport()">Wy≈õlij raport patrolu</button>
                        </div>
                    </div>
                    <div id="statusRaportPatrol"></div>
                </div>

                <div id="interwencjaFields" style="display:none;">
                    <label>Komenda:</label>
                    <input type="text" id="komendaInterw" value="Komenda Wojew√≥dzka Policji w Gda≈Ñsku ‚Äì Summer RP" />

                    <div class="row">
                        <div>
                            <label>Data i godzina interwencji:</label>
                            <input type="datetime-local" id="dataCzasInterw" />
                        </div>
                        <div>
                            <label>Miejsce zdarzenia:</label>
                            <input type="text" id="miejsceInterw" placeholder="np. Stacja paliw ‚Äì ul. Le≈õna 13, Gda≈Ñsk" />
                        </div>
                    </div>

                    <label>Zg≈Çoszenie:</label>
                    <input type="text" id="zg≈ÇoszenieInterw" placeholder="np. Podejrzenie napadu z broniƒÖ ‚Äì zg≈Çoszenie przez 112" />

                    <label>Funkcjonariusze uczestniczƒÖcy (oddzielone nowƒÖ liniƒÖ):</label>
                    <textarea id="funkcjonariuszeInterw" placeholder="st. post. Jan Kami≈Ñski\nsier≈º. szt. Marek Nowak"></textarea>

                    <label>Opis przebiegu interwencji:</label>
                    <textarea id="opisInterw" placeholder="Np. Po przybyciu na miejsce..."></textarea>

                    <label>Zatrzymane osoby (je≈õli dotyczy):</label>
                    <textarea id="zatrzymaneOsoby" placeholder="Imiƒô i Nazwisko ‚Äì pow√≥d zatrzymania\nPrzewieziono na KWP..."></textarea>

                    <label>Dowody zabezpieczone (ka≈ºdy w nowej linii):</label>
                    <textarea id="dowodyInterw" placeholder="Pistolet Glock 17\nGot√≥wka 12 000 PLN\nNagranie z monitoringu"></textarea>

                    <label>Uwagi ko≈Ñcowe:</label>
                    <textarea id="uwagiInterw" placeholder="Np. Sprawa przekazana do WD≈ö..."></textarea>

                    <label>Raport sporzƒÖdzi≈Ç (stopie≈Ñ + imiƒô i nazwisko):</label>
                    <input type="text" id="sporadzilInterw" placeholder="np. sier≈º. szt. Marek Nowak" />

                    <div class="row">
                        <div>
                            <label>Data sporzƒÖdzenia:</label>
                            <input type="date" id="dataSporzadzeniaInterw" />
                        </div>
                        <div>
                            <label>&nbsp;</label>
                            <button type="button" class="send-btn" onclick="sendInterwReport()">Wy≈õlij raport interwencji</button>
                        </div>
                    </div>
                    <div id="statusRaportInterw"></div>
                </div>

                <div id="statusRaport" style="margin-top:14px;"></div>
            </form>
        </div>

        <div id="zatrzymanie" class="tab">
            <form id="zatrzymanieForm">
                <label>Data i godzina zatrzymania:</label>
                <input type="datetime-local" id="dataCzasZatrzymania" required />

                <div class="row">
                    <div>
                        <label>Funkcjonariusz (Stopie≈Ñ + Imiƒô i Nazwisko):</label>
                        <input type="text" id="funkcjonariuszZatrzymanie" required placeholder="np. sier≈º. sztab. Marek Nowak" />
                    </div>
                    <div>
                        <label>Nick Funkcjonariusza (OOC):</label>
                        <input type="text" id="nickFuncZatrzymanie" required placeholder="np. Funkcjonariusz#1234" />
                    </div>
                </div>

                <label>Imiƒô i Nazwisko osoby zatrzymanej (IC):</label>
                <input type="text" id="osobaZatrzymanaIC" required placeholder="np. Tomasz Malinowski" />

                <label>ID / Numer dowodu osoby zatrzymanej (opcjonalnie):</label>
                <input type="text" id="idDowodZatrzymanie" placeholder="np. 90021204856" />

                <label>Miejsce zatrzymania:</label>
                <input type="text" id="miejsceZatrzymania" required placeholder="np. Gda≈Ñsk, ul. D≈Çuga 12, przed budynkiem banku" />

                <label>Pow√≥d zatrzymania:</label>
                <textarea id="powodZatrzymania" required placeholder="np. Ucieczka przed kontrolƒÖ, posiadanie nielegalnej broni, pobicie, itp."></textarea>

                <label>Zabezpieczone przedmioty (je≈õli dotyczy, ka≈ºdy w nowej linii):</label>
                <textarea id="zabezpieczonePrzedmioty" placeholder="Pistolet Glock 17\Got√≥wka 12 000 PLN\Prawo jazdy z fa≈Çszywymi danymi"></textarea>

                <label>Czas trwania zatrzymania:</label>
                <input type="text" id="czasTrwaniaZatrzymania" required placeholder="np. od 22:15 do 23:05 ‚Äì 50 minut" />

                <label>Uwagi ko≈Ñcowe (zachowanie, adwokat, itp.):</label>
                <textarea id="uwagiZatrzymanie" placeholder="Osoba zatrzymana nie stawia≈Ça oporu. Skontaktowano siƒô z adwokatem."></textarea>

                <label>Data sporzƒÖdzenia protoko≈Çu:</label>
                <input type="date" id="dataSporzadzeniaZatrzymania" required />

                <button type="button" class="send-btn" onclick="sendZatrzymanieProtocol()">Wy≈õlij Protok√≥≈Ç Zatrzymania</button>
            </form>
            <div id="statusZatrzymanie"></div>
        </div>

    </div>

    <script>
        // Webhooky
        const webhookMandat = 'https://discord.com/api/webhooks/1403683432227410001/aSOQ2awWpU5bBgGsgo1E0k_kkBIGU6bwOUEBsuSXgaVc-vp3-cmAlIWk5wHSkkdLheNg';
        const webhookSadDecyzja = 'https://discord.com/api/webhooks/1403681144029057074/qWog2W1UxsgQp1P_IzmI0sqjmXtC7ZD4Fw3XsGhLX39AFaW31cyTC1Y0bNh6AfeqXy8c';
        const webhookWniosekSad = 'https://discord.com/api/webhooks/1412788434648694804/n60lhu1ldk_rwms5f7TCE5XE3JO8XM-TZ4zReqem8dKynqoohH5_e4HFuLpINYiVDCnd';
        // Webhook dla raport√≥w i protoko≈Çu zatrzymania
        const webhookRaport = 'https://discord.com/api/webhooks/1434821037069045853/0iztVif0V05Up-p8MbO33dgoDeUzDeeOBaU0nQGHZpnuNp81IhfOfSYsxzQ_4Wg4Zgew';

        // Funkcje pomocnicze
        function showTab(id, event) {
            const tabs = document.querySelectorAll('.tab');
            const tabBtns = document.querySelectorAll('.tab-btn');
            tabs.forEach(t => t.classList.remove('active'));
            tabBtns.forEach(b => b.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            if (event && event.currentTarget) event.currentTarget.classList.add('active');
        }

        function toggleInnePole() {
            const przyczyna = document.getElementById('przyczyna').value;
            document.getElementById('innePrzyczynaDiv').style.display = przyczyna === 'inne' ? 'block' : 'none';
        }

        function toggleRaportType() {
            const type = document.getElementById('rodzajRaportu').value;
            document.getElementById('patrolFields').style.display = type === 'patrol' ? 'block' : 'none';
            document.getElementById('interwencjaFields').style.display = type === 'interwencja' ? 'block' : 'none';
        }

        async function wyslijWebhook(url, embed, content = null) {
            const bodyObj = content ? { content: content, embeds: [embed] } : { embeds: [embed] };
            const response = await fetch(url, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify(bodyObj)
            });
            if (!response.ok) {
                throw new Error(`B≈ÇƒÖd sieci: ${response.status} ${response.statusText}`);
            }
            return response;
        }

        function setStatus(elementId, message, isSuccess) {
            const el = document.getElementById(elementId);
            if (!el) return;
            el.textContent = message;
            el.classList.remove('status-success', 'status-error');
            if (isSuccess === true) el.classList.add('status-success');
            if (isSuccess === false) el.classList.add('status-error');
        }

        function escapeNewlinesAsQuote(text) {
            if (!text) return '‚Äî';
            return text.split('\n').map(line => `> ${line}`).join('\n');
        }
        function escapeNewlinesAsList(text) {
            if (!text) return '‚Äî';
            return text.split('\n').map(line => `‚Ä¢ ${line}`).join('\n');
        }

        // --- G≈Å√ìWNA LOGIKA DLA SEKCJI ---

        // MANDAT
        document.getElementById('mandatForm').addEventListener('submit', async e => {
            e.preventDefault();
            setStatus('statusMandat', 'Wysy≈Çam mandat...', null);
            try {
                const imie = document.getElementById('imie').value.trim();
                const nick = document.getElementById('nick').value.trim();
                const dataWystawieniaRaw = document.getElementById('dataWystawienia').value;
                const godzinaZdarzeniaRaw = document.getElementById('godzinaZdarzenia').value;
                const miejsce = document.getElementById('miejsce').value.trim();
                let przyczyna = document.getElementById('przyczyna').value;
                if (przyczyna === 'inne') {
                    const inneText = document.getElementById('innePrzyczyna').value.trim();
                    if (!inneText) {
                        setStatus('statusMandat', 'Proszƒô wpisaƒá opis innej przyczyny.', false);
                        return;
                    }
                    przyczyna = inneText;
                }
                const kwota = Number(document.getElementById('kwota').value);
                const punkty = Number(document.getElementById('punkty').value);
                const pojazd = document.getElementById('pojazd').value.trim();
                const funkcjonariusz = document.getElementById('funkcjonariusz').value.trim();

                const dataObj = new Date(dataWystawieniaRaw);
                const dataStr = isNaN(dataObj) ? '‚Äî' : (dataObj.toLocaleDateString('pl-PL') + ', godz. ' + dataObj.toLocaleTimeString('pl-PL', {hour:'2-digit',minute:'2-digit'}));
                const godzinaZdarzenia = godzinaZdarzeniaRaw || '‚Äî';

                const embed = {
                    title: ":money_with_wings: MANDAT KARNY",
                    description: "**Komenda Wojew√≥dzka Policji w Gda≈Ñsku ‚Äì Summer RP**",
                    color: 0xdc143c,
                    fields: [
                        { name: '\u200b', value: `**Dane osoby ukaranej**\n> Imiƒô i nazwisko: **${imie}**\n> Nick (OOC): ${nick}` },
                        { name: '\u200b', value: `**Informacje o zdarzeniu**\n> Data i godzina wystawienia: **${dataStr}**\n> Godzina zdarzenia: **${godzinaZdarzenia}**\n> Miejsce zdarzenia: **${miejsce}**` },
                        { name: '\u200b', value: `**Przyczyna na≈Ço≈ºenia mandatu**\n> **${przyczyna}**` },
                        { name: '\u200b', value: `**Wymiar kary**\n> Kwota mandatu: **${kwota.toLocaleString()} PLN**\n> Punkty karne: **${punkty} pkt**` },
                        { name: '\u200b', value: `**Dane pojazdu**\n> Typ: ${pojazd}` },
                        { name: '\u200b', value: `**Funkcjonariusz wystawiajƒÖcy**\n> **${funkcjonariusz}**` },
                        { name: ':warning: Informacja', value: 'Mandat nale≈ºy ui≈õciƒá w terminie 7 dni. Brak zap≈Çaty skutkuje wszczƒôciem postƒôpowania.' },
                    ],
                    footer: { text: "Komenda Wojew√≥dzka Policji w Gda≈Ñsku ‚Äì Summer RP" },
                    timestamp: new Date().toISOString(),
                };

                await wyslijWebhook(webhookMandat, embed);
                setStatus('statusMandat', 'Mandat zosta≈Ç wys≈Çany pomy≈õlnie!', true);
                e.target.reset();
                toggleInnePole();

            } catch(err) {
                setStatus('statusMandat', 'B≈ÇƒÖd podczas wysy≈Çania mandatu: ' + err.message, false);
            }
        });

        // WNIOSEK
        document.getElementById('wniosekForm').addEventListener('submit', async e => {
            e.preventDefault();
            setStatus('statusWniosek', 'Wysy≈Çam wniosek do sƒÖdu...', null);
            try {
                const ukarany = document.getElementById('ukarany').value.trim();
                const nick = document.getElementById('nickWniosek').value.trim() || '‚Äî';
                const dataMandatu = document.getElementById('dataMandatu').value || '‚Äî';
                const typMandatu = document.getElementById('typMandatu').value.trim() || '‚Äî';
                const kwotaMandatu = document.getElementById('kwotaMandatu').value ? Number(document.getElementById('kwotaMandatu').value) : '‚Äî';
                const powod = document.getElementById('powod').value.trim();
                
                if (powod === '') {
                    setStatus('statusWniosek', 'Proszƒô opisaƒá pow√≥d wniosku.', false);
                    return;
                }

                const embed = {
                    title: ":scroll: WNIOSEK DO SƒÑDU",
                    description: "**Komenda Wojew√≥dzka Policji w Gda≈Ñsku ‚Äì Summer RP**",
                    color: 0x3b82f6,
                    fields: [
                        { name: '\u200b', value: `**Dane osoby ukaranej**\n> Imiƒô i nazwisko: **${ukarany}**\n> Nick (OOC): ${nick}` },
                        { name: '\u200b', value: `**Szczeg√≥≈Çy mandatu**\n> Data wystawienia: **${dataMandatu}**\n> Typ mandatu: **${typMandatu}**\n> Kwota mandatu: **${kwotaMandatu === '‚Äî' ? '‚Äî' : `${kwotaMandatu.toLocaleString()} PLN`}**` },
                        { name: '\u200b', value: `**Opis sprawy / pow√≥d wniosku**\n> ${powod}` },
                        { name: ':information_source: Informacja', value: 'Decyzja sƒÖdu zostanie wys≈Çana na odpowiedni kana≈Ç Discord.' }
                    ],
                    footer: { text: "Komenda Wojew√≥dzka Policji w Gda≈Ñsku ‚Äì Summer RP" },
                    timestamp: new Date().toISOString(),
                };

                await wyslijWebhook(webhookWniosekSad, embed);
                setStatus('statusWniosek', 'Wniosek wys≈Çany! Oczekiwanie na decyzjƒô sƒÖdu...', true);
                e.target.reset();

            } catch(err) {
                setStatus('statusWniosek', 'B≈ÇƒÖd podczas wysy≈Çania wniosku: ' + err.message, false);
            }
        });

        // RAPORT - PATROL
        async function sendPatrolReport() {
            try {
                setStatus('statusRaportPatrol', 'Wysy≈Çam raport patrolu...', null);

                const komenda = document.getElementById('komendaPatrol').value || 'Komenda Wojew√≥dzka Policji w Gda≈Ñsku ‚Äì Summer RP';
                const dataSluzby = document.getElementById('dataSluzby').value || '‚Äî';
                const czasTrwania = document.getElementById('czasTrwania').value || '‚Äî';
                const sklad = document.getElementById('skladPatrolu').value.trim() || '‚Äî';
                
                // rodzaj patrolu - zebraƒá zaznaczone
                const rodzajElems = document.querySelectorAll('#patrolFields input[name="rodzaj"]:checked');
                let rodzaje = Array.from(rodzajElems).map(el => el.value);
                const rodzajInny = document.getElementById('rodzajInny').value.trim();
                if (rodzaje.includes('Inny') && rodzajInny) {
                    // zamie≈Ñ 'Inny' na konkret
                    rodzaje = rodzaje.map(r => r === 'Inny' ? `Inny: ${rodzajInny}` : r);
                }
                if (rodzaje.length === 0) rodzaje = ['‚Äî'];

                const obszar = document.getElementById('obszarPatrolu').value.trim() || '‚Äî';
                const czynnosci = document.getElementById('czynnosciPatrolu').value.trim() || '‚Äî';
                const incydenty = document.getElementById('incydentyPatrolu').value.trim() || 'Brak';
                const uwagi = document.getElementById('uwagiPatrolu').value.trim() || '‚Äî';
                const sporadzil = document.getElementById('sporadzilPatrol').value.trim() || '‚Äî';
                const dataSporz = document.getElementById('dataSporzadzeniaPatrol').value || (new Date()).toLocaleDateString('pl-PL');

                // zbuduj tekst embedu zgodnie ze wzorem
                const embed = {
                    title: "üìã RAPORT ZE S≈ÅU≈ªBY / PATROLU",
                    description: `**${komenda}**`,
                    color: 3447003,
                    fields: [
                        { name: 'Data s≈Çu≈ºby', value: dataSluzby, inline: true },
                        { name: 'Czas trwania s≈Çu≈ºby', value: czasTrwania, inline: true },
                        { name: '\u200b', value: `**Sk≈Çad patrolu**\n${escapeNewlinesAsQuote(sklad)}` },
                        { name: 'Rodzaj patrolu', value: rodzaje.join(', ') },
                        { name: 'Obszar patrolu', value: obszar },
                        { name: 'Wykonane czynno≈õci', value: escapeNewlinesAsList(czynnosci) },
                        { name: 'Incydenty i interwencje', value: incydenty },
                        { name: 'Uwagi w≈Çasne', value: uwagi },
                        { name: 'Raport sporzƒÖdzi≈Ç', value: sporadzil },
                        { name: 'Data sporzƒÖdzenia', value: dataSporz }
                    ],
                    timestamp: new Date().toISOString(),
                    footer: { text: komenda }
                };

                await wyslijWebhook(webhookRaport, embed, "**Nowy raport patrolu**");
                setStatus('statusRaportPatrol', 'Raport patrolu wys≈Çany pomy≈õlnie!', true);
                
                // wyczyszczenie p√≥l
                document.getElementById('skladPatrolu').value = '';
                document.querySelectorAll('#patrolFields input[name="rodzaj"]').forEach(i => i.checked = false);
                document.getElementById('rodzajInny').value = '';
                document.getElementById('obszarPatrolu').value = '';
                document.getElementById('czynnosciPatrolu').value = '';
                document.getElementById('incydentyPatrolu').value = '';
                document.getElementById('uwagiPatrolu').value = '';
                document.getElementById('sporadzilPatrol').value = '';
                document.getElementById('dataSporzadzeniaPatrol').value = '';

            } catch(err) {
                setStatus('statusRaportPatrol', 'B≈ÇƒÖd podczas wysy≈Çania raportu patrolu: ' + err.message, false);
            }
        }

        // RAPORT - INTERWENCJA
        async function sendInterwReport() {
            try {
                setStatus('statusRaportInterw', 'Wysy≈Çam raport interwencji...', null);

                const komenda = document.getElementById('komendaInterw').value || 'Komenda Wojew√≥dzka Policji w Gda≈Ñsku ‚Äì Summer RP';
                const dataCzas = document.getElementById('dataCzasInterw').value;
                const dataCzasStr = dataCzas ? (new Date(dataCzas)).toLocaleString('pl-PL') : '‚Äî';
                const miejsce = document.getElementById('miejsceInterw').value.trim() || '‚Äî';
                const zgloszenie = document.getElementById('zg≈ÇoszenieInterw').value.trim() || '‚Äî';
                const funkcjonariusze = document.getElementById('funkcjonariuszeInterw').value.trim() || '‚Äî';
                const opis = document.getElementById('opisInterw').value.trim() || '‚Äî';
                const zatrzymane = document.getElementById('zatrzymaneOsoby').value.trim() || 'Brak';
                const dowody = document.getElementById('dowodyInterw').value.trim() || 'Brak';
                const uwagi = document.getElementById('uwagiInterw').value.trim() || '‚Äî';
                const sporadzil = document.getElementById('sporadzilInterw').value.trim() || '‚Äî';
                const dataSporz = document.getElementById('dataSporzadzeniaInterw').value || (new Date()).toLocaleDateString('pl-PL');

                const embed = {
                    title: "üìÑ RAPORT Z INTERWENCJI",
                    description: `**${komenda}**`,
                    color: 15105570,
                    fields: [
                        { name: 'Data i godzina interwencji', value: dataCzasStr },
                        { name: 'Miejsce zdarzenia', value: miejsce },
                        { name: 'Zg≈Çoszenie', value: zgloszenie },
                        { name: 'Funkcjonariusze uczestniczƒÖcy', value: escapeNewlinesAsQuote(funkcjonariusze) },
                        { name: 'Opis przebiegu interwencji', value: opis },
                        { name: 'Zatrzymane osoby', value: zatrzymane },
                        { name: 'Dowody zabezpieczone', value: escapeNewlinesAsList(dowody) },
                        { name: 'Uwagi ko≈Ñcowe', value: uwagi },
                        { name: 'Raport sporzƒÖdzi≈Ç', value: sporadzil },
                        { name: 'Data sporzƒÖdzenia raportu', value: dataSporz }
                    ],
                    timestamp: new Date().toISOString(),
                    footer: { text: komenda }
                };

                await wyslijWebhook(webhookRaport, embed, "**Nowy raport z interwencji**");
                setStatus('statusRaportInterw', 'Raport interwencji wys≈Çany pomy≈õlnie!', true);

                // wyczyszczenie
                document.getElementById('miejsceInterw').value = '';
                document.getElementById('zg≈ÇoszenieInterw').value = '';
                document.getElementById('funkcjonariuszeInterw').value = '';
                document.getElementById('opisInterw').value = '';
                document.getElementById('zatrzymaneOsoby').value = '';
                document.getElementById('dowodyInterw').value = '';
                document.getElementById('uwagiInterw').value = '';
                document.getElementById('sporadzilInterw').value = '';
                document.getElementById('dataSporzadzeniaInterw').value = '';

            } catch(err) {
                setStatus('statusRaportInterw', 'B≈ÇƒÖd podczas wysy≈Çania raportu interwencji: ' + err.message, false);
            }
        }

        // PROTOK√ì≈Å ZATRZYMANIA (NOWA FUNKCJA)
        async function sendZatrzymanieProtocol() {
            try {
                setStatus('statusZatrzymanie', 'Wysy≈Çam protok√≥≈Ç zatrzymania...', null);

                const dataCzasZatrzymaniaRaw = document.getElementById('dataCzasZatrzymania').value;
                const dataCzasZatrzymaniaStr = dataCzasZatrzymaniaRaw ? (new Date(dataCzasZatrzymaniaRaw)).toLocaleString('pl-PL') : '‚Äî';
                
                const funkcjonariusz = document.getElementById('funkcjonariuszZatrzymanie').value.trim() || '‚Äî';
                const nickFunc = document.getElementById('nickFuncZatrzymanie').value.trim() || '‚Äî';
                
                const osobaZatrzymanaIC = document.getElementById('osobaZatrzymanaIC').value.trim() || '‚Äî';
                const idDowod = document.getElementById('idDowodZatrzymanie').value.trim() || '‚Äî';
                
                const miejsce = document.getElementById('miejsceZatrzymania').value.trim() || '‚Äî';
                const powod = document.getElementById('powodZatrzymania').value.trim() || '‚Äî';
                const zabezpieczone = document.getElementById('zabezpieczonePrzedmioty').value.trim() || 'Brak';
                const czasTrwania = document.getElementById('czasTrwaniaZatrzymania').value.trim() || '‚Äî';
                const uwagi = document.getElementById('uwagiZatrzymanie').value.trim() || 'Brak';
                const dataSporz = document.getElementById('dataSporzadzeniaZatrzymania').value || (new Date()).toLocaleDateString('pl-PL');

                // Weryfikacja podstawowa
                if (!dataCzasZatrzymaniaRaw || !funkcjonariusz || !nickFunc || !osobaZatrzymanaIC || !miejsce || !powod) {
                     setStatus('statusZatrzymanie', 'Proszƒô wype≈Çniƒá wszystkie wymagane pola (oznaczone gwiazdkƒÖ).', false);
                    return;
                }

                const embed = {
                    title: "üö® PROTOK√ì≈Å ZATRZYMANIA",
                    description: "**Komenda Wojew√≥dzka Policji w Gda≈Ñsku ‚Äì Summer RP**",
                    color: 0xed6a5a, // Czerwony/pomara≈Ñczowy kolor dla zatrzymania
                    fields: [
                        { name: 'Data i godzina zatrzymania', value: `**${dataCzasZatrzymaniaStr}**` },
                        { name: 'Funkcjonariusz dokonujƒÖcy zatrzymania', value: `> **${funkcjonariusz}**\n> Nick OOC: ${nickFunc}` },
                        { name: 'Dane osoby zatrzymanej', value: `> Imiƒô i Nazwisko (IC): **${osobaZatrzymanaIC}**\n> ID / Numer dowodu: ${idDowod}` },
                        { name: 'Miejsce zatrzymania', value: miejsce },
                        { name: 'Pow√≥d zatrzymania', value: `**${powod}**` },
                        { name: 'Zabezpieczone przedmioty (je≈õli dotyczy)', value: escapeNewlinesAsList(zabezpieczone) },
                        { name: 'Czas trwania zatrzymania', value: czasTrwania },
                        { name: 'Uwagi', value: uwagi },
                        { name: '--- Podpis funkcjonariusza (IC) ---', value: `**${funkcjonariusz}**\nData sporzƒÖdzenia protoko≈Çu: **${dataSporz}**` }
                    ],
                    timestamp: new Date().toISOString(),
                    footer: { text: "Komenda Wojew√≥dzka Policji w Gda≈Ñsku ‚Äì Summer RP" }
                };

                await wyslijWebhook(webhookRaport, embed, "**Nowy protok√≥≈Ç zatrzymania**");
                setStatus('statusZatrzymanie', 'Protok√≥≈Ç zatrzymania zosta≈Ç wys≈Çany pomy≈õlnie!', true);
                
                // Resetowanie formularza
                document.getElementById('zatrzymanieForm').reset();

            } catch(err) {
                setStatus('statusZatrzymanie', 'B≈ÇƒÖd podczas wysy≈Çania protoko≈Çu zatrzymania: ' + err.message, false);
            }
        }

        // Pre-init
        toggleRaportType();
    </script>
</body>
</html>
